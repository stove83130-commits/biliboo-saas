# Guide Complet : Configuration de Resend pour Bilibou

## üìã Table des mati√®res
1. [Cr√©er un compte Resend](#1-cr√©er-un-compte-resend)
2. [Obtenir votre cl√© API](#2-obtenir-votre-cl√©-api)
3. [V√©rifier un domaine ou utiliser l'email par d√©faut](#3-v√©rifier-un-domaine-ou-utiliser-lemail-par-d√©faut)
4. [Configurer les variables dans Vercel](#4-configurer-les-variables-dans-vercel)
5. [Tester l'envoi d'emails](#5-tester-lenvoi-demails)

---

## 1. Cr√©er un compte Resend

### √âtapes :
1. Allez sur **https://resend.com**
2. Cliquez sur **"Get Started"** ou **"Sign Up"** en haut √† droite
3. Choisissez de vous inscrire avec :
   - Votre email Google
   - Ou votre email GitHub
   - Ou cr√©ez un compte avec email/mot de passe
4. Remplissez le formulaire et confirmez votre email

### üí° Conseil
Utilisez votre email professionnel si vous en avez un, c'est plus simple pour la gestion.

---

## 2. Obtenir votre cl√© API

### √âtapes :
1. Une fois connect√© √† Resend, vous arrivez sur le **Dashboard**
2. Dans le menu de gauche, cliquez sur **"API Keys"** (ou "Cl√©s API")
3. Vous verrez peut-√™tre une cl√© d√©j√† cr√©√©e, ou vous devrez en cr√©er une
4. Cliquez sur **"Create API Key"** (ou "+ Add API Key")
5. Donnez-lui un nom : **"Bilibou Production"** (ou autre nom de votre choix)
6. Choisissez les **permissions** :
   - Cochez **"Sending access"** (acc√®s envoi)
   - Vous pouvez aussi cocher **"Full access"** si vous voulez tout g√©rer
7. Cliquez sur **"Add"** ou **"Create"**
8. ‚ö†Ô∏è **IMPORTANT** : Resend affichera votre cl√© UNE SEULE FOIS
   - Elle commence par `re_` suivi de lettres et chiffres
   - Exemple : `re_abc123XYZ456def789ghi012`
   - **Copiez-la imm√©diatement et collez-la dans un fichier texte s√©curis√©**

### üîí S√©curit√©
- Ne partagez JAMAIS cette cl√© publiquement
- Ne la commitez JAMAIS dans Git
- Si vous la perdez, supprimez-la et cr√©ez-en une nouvelle

---

## 3. V√©rifier un domaine ou utiliser l'email par d√©faut

### Option A : Utiliser l'email par d√©faut de Resend (Plus simple pour commencer)

Resend vous donne un email par d√©faut qui fonctionne directement :
- Format : `onboarding@resend.dev`
- ‚úÖ Vous pouvez l'utiliser imm√©diatement pour tester
- ‚ö†Ô∏è Limitation : Les emails peuvent parfois aller dans les spams

### Option B : V√©rifier votre propre domaine (Recommand√© pour production)

Si vous avez un domaine (ex: `bilibou.com`) :

1. Dans Resend, allez dans **"Domains"** dans le menu de gauche
2. Cliquez sur **"Add Domain"**
3. Entrez votre domaine (ex: `bilibou.com`) - SANS le `www` ni `http://`
4. Resend vous donnera des enregistrements DNS √† ajouter :
   - Allez dans votre h√©bergeur de domaine (ex: Namecheap, Cloudflare, etc.)
   - Ajoutez les enregistrements TXT et CNAME fournis par Resend
   - Attendez 5-30 minutes que la v√©rification se fasse
5. Une fois v√©rifi√© (statut "Verified" ‚úì), vous pourrez utiliser :
   - `noreply@bilibou.com`
   - `contact@bilibou.com`
   - etc.

### üéØ Recommandation pour commencer

Pour commencer rapidement, utilisez **Option A** (`onboarding@resend.dev`) pour tester. Vous pourrez v√©rifier votre domaine plus tard.

---

## 4. Configurer les variables dans Vercel

### √âtapes :

1. **Ouvrez Vercel**
   - Allez sur https://vercel.com
   - Connectez-vous
   - S√©lectionnez votre projet Bilibou

2. **Acc√©dez aux variables d'environnement**
   - Cliquez sur **"Settings"** (Param√®tres)
   - Dans le menu de gauche, cliquez sur **"Environment Variables"**

3. **Supprimez les anciennes variables (noms en fran√ßais)** si elles existent :
   - `H√îTE SMTP`
   - `PORT SMTP`
   - `SMTP_S√âCURIS√â`
   - `UTILISATEUR SMTP`
   - `EXPORTATIONS_DEPUIS_EMAIL`
   - (Gardez `SMTP_PASS` et `SMTP_FROM` si vous les utilisez pour un fallback)

4. **Ajoutez/modifiez les variables Resend** :

   a) **RESEND_API_KEY**
   - Cliquez sur **"Add New"**
   - Name: `RESEND_API_KEY`
   - Value: Collez votre cl√© API Resend (celle qui commence par `re_`)
   - Environnements: S√©lectionnez **"Production"**, **"Preview"**, et **"Development"** (ou au minimum Production)
   - Cliquez sur **"Save"**

   b) **EXPORTS_FROM_EMAIL**
   - Cliquez sur **"Add New"**
   - Name: `EXPORTS_FROM_EMAIL`
   - Value: 
     - Si vous utilisez l'email par d√©faut : `onboarding@resend.dev`
     - Si vous avez v√©rifi√© un domaine : `noreply@votre-domaine.com`
   - Environnements: S√©lectionnez tous
   - Cliquez sur **"Save"**

   c) **INVITES_FROM_EMAIL** (Optionnel - mais recommand√©)
   - Cliquez sur **"Add New"**
   - Name: `INVITES_FROM_EMAIL`
   - Value: M√™me valeur que `EXPORTS_FROM_EMAIL`
   - Environnements: S√©lectionnez tous
   - Cliquez sur **"Save"**

5. **V√©rifiez vos variables**
   - Vous devriez avoir au minimum :
     - ‚úÖ `RESEND_API_KEY`
     - ‚úÖ `EXPORTS_FROM_EMAIL`
     - (Optionnel : `INVITES_FROM_EMAIL`)

---

## 5. Tester l'envoi d'emails

### Apr√®s avoir configur√© les variables :

1. **Red√©ployez votre application**
   - Dans Vercel, allez dans **"Deployments"**
   - Cliquez sur les trois points (...) du dernier d√©ploiement
   - Cliquez sur **"Redeploy"** (ou attendez le prochain push Git)

2. **Testez une invitation**
   - Allez sur votre site en production
   - Cr√©ez/allez dans une organisation
   - Essayez d'inviter un membre avec votre propre email de test
   - Vous devriez recevoir l'email d'invitation

3. **V√©rifiez les logs**
   - Dans Vercel, allez dans **"Functions"** ‚Üí **"Logs"**
   - Cherchez les messages commen√ßant par `‚úÖ Email d'invitation envoy√© via Resend`
   - Si vous voyez `‚ùå Erreur Resend:`, notez le message d'erreur

---

## üîß Troubleshooting

### Probl√®me : "Invalid API key"
- V√©rifiez que vous avez bien copi√© toute la cl√© (elle doit commencer par `re_`)
- V√©rifiez que vous n'avez pas d'espaces avant/apr√®s la cl√©
- Cr√©ez une nouvelle cl√© API dans Resend si n√©cessaire

### Probl√®me : "Domain not verified"
- Si vous utilisez un domaine personnalis√©, v√©rifiez qu'il est bien v√©rifi√© dans Resend
- Utilisez temporairement `onboarding@resend.dev` pour tester

### Probl√®me : L'email n'arrive pas
1. V√©rifiez les **logs Vercel** pour voir s'il y a des erreurs
2. V√©rifiez le **dashboard Resend** ‚Üí **"Logs"** pour voir l'√©tat de l'envoi
3. V√©rifiez vos **spams/courrier ind√©sirable**
4. Essayez avec une autre adresse email

### Probl√®me : "From email address not authorized"
- Utilisez un email v√©rifi√© dans Resend
- Pour tester, utilisez `onboarding@resend.dev`
- Si vous utilisez votre domaine, assurez-vous qu'il est v√©rifi√©

---

## üìä V√©rifier les envois dans Resend

Pour voir tous les emails envoy√©s :
1. Allez sur votre dashboard Resend
2. Cliquez sur **"Logs"** ou **"Emails"**
3. Vous verrez tous les emails envoy√©s, leur statut (d√©livr√©, ouvert, etc.)

---

## üí∞ Plans et limites Resend

### Plan Gratuit
- ‚úÖ 3,000 emails/mois
- ‚úÖ 100 emails/jour
- ‚úÖ Support par email
- ‚úÖ Logs d'emails

### Plans payants (si besoin)
- Commencent √† $20/mois pour 50,000 emails

Pour commencer, le plan gratuit est largement suffisant !

---

## ‚úÖ Checklist finale

- [ ] Compte Resend cr√©√©
- [ ] Cl√© API Resend copi√©e (commence par `re_`)
- [ ] Variable `RESEND_API_KEY` ajout√©e dans Vercel
- [ ] Variable `EXPORTS_FROM_EMAIL` ajout√©e dans Vercel
- [ ] Application red√©ploy√©e sur Vercel
- [ ] Test d'invitation effectu√©
- [ ] Email re√ßu (ou v√©rifi√© dans les logs)

---

## üéâ Une fois tout configur√©

Vos invitations fonctionneront automatiquement ! Le syst√®me utilisera Resend en priorit√©, et si √ßa √©choue, il essaiera SMTP en fallback (si configur√©).

