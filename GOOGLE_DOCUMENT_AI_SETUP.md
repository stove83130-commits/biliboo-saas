# ü§ñ Configuration Google Document AI

Ce guide explique comment configurer **Google Document AI** pour extraire automatiquement les donn√©es des factures PDF.

---

## üìã **Pr√©requis**

- ‚úÖ Compte Google Cloud actif
- ‚úÖ Carte bancaire (pour activer l'API, mais 1 000 pages/mois gratuites)

---

## üöÄ **√âtapes de Configuration**

### **1Ô∏è‚É£ Activer l'API Document AI**

1. Allez sur [Google Cloud Console](https://console.cloud.google.com/)
2. S√©lectionnez votre projet (ou cr√©ez-en un nouveau)
3. Dans la barre de recherche, tapez **"Document AI API"**
4. Cliquez sur **"Activer"**

---

### **2Ô∏è‚É£ Cr√©er un Processeur Invoice Parser**

1. Dans Google Cloud Console, allez dans **"Document AI"** ‚Üí **"Processeurs"**
2. Cliquez sur **"Cr√©er un processeur"**
3. S√©lectionnez **"Invoice Parser"** (sp√©cialis√© pour les factures)
4. Donnez-lui un nom (ex: `tradia-invoice-extractor`)
5. Choisissez la r√©gion **"eu"** (Europe)
6. **Notez l'ID du processeur** (vous en aurez besoin plus tard)
   - Format : `1234567890abcdef`

---

### **3Ô∏è‚É£ Cr√©er un Compte de Service**

1. Allez dans **"IAM & Admin"** ‚Üí **"Comptes de service"**
2. Cliquez sur **"Cr√©er un compte de service"**
3. Nom : `tradia-invoice-extractor`
4. Description : `Service d'extraction de factures avec Document AI`
5. Cliquez sur **"Cr√©er et continuer"**
6. R√¥le : S√©lectionnez **"Document AI API User"**
7. Cliquez sur **"Continuer"** puis **"Termin√©"**

---

### **4Ô∏è‚É£ T√©l√©charger la Cl√© JSON**

1. Dans la liste des comptes de service, cliquez sur celui que vous venez de cr√©er
2. Allez dans l'onglet **"Cl√©s"**
3. Cliquez sur **"Ajouter une cl√©"** ‚Üí **"Cr√©er une cl√©"**
4. Format : **JSON**
5. Cliquez sur **"Cr√©er"**
6. Le fichier JSON sera t√©l√©charg√© automatiquement

---

### **5Ô∏è‚É£ Configurer le Projet**

1. **Placez le fichier JSON t√©l√©charg√©** √† la racine de votre projet :
   ```
   C:\Users\Noa\Desktop\tradia\google-credentials.json
   ```

2. **Ajoutez ces variables dans `.env.local`** :

```bash
# ========================================
# ü§ñ GOOGLE DOCUMENT AI
# ========================================

# Chemin vers le fichier JSON des credentials
GOOGLE_APPLICATION_CREDENTIALS=./google-credentials.json

# ID de votre projet Google Cloud
GOOGLE_CLOUD_PROJECT_ID=votre-projet-id

# ID du processeur Invoice Parser
GOOGLE_DOCUMENT_AI_PROCESSOR_ID=votre-processor-id

# R√©gion du processeur (eu, us, asia)
GOOGLE_DOCUMENT_AI_LOCATION=eu
```

3. **Remplacez les valeurs** :
   - `votre-projet-id` : ID de votre projet Google Cloud (ex: `tradia-invoice-extractor`)
   - `votre-processor-id` : ID du processeur cr√©√© √† l'√©tape 2 (ex: `1234567890abcdef`)

---

## üß™ **Tester l'Installation**

1. **Red√©marrez le serveur** :
   ```bash
   npm run dev
   ```

2. **Lancez une extraction** depuis le dashboard

3. **V√©rifiez les logs** dans le terminal :
   ```
   ü§ñ [Document AI] Extraction de Invoice-XXX.pdf...
   üì§ [Document AI] Envoi du PDF √† Google Cloud...
   ‚úÖ [Document AI] Document trait√© avec succ√®s
   ‚úÖ [Document AI] Donn√©es extraites :
      - Vendeur: Anthropic, PBC
      - Montant: 123.45 EUR
      - Adresse: 123 Rue Exemple
      - Ville: Paris
      - Pays: France
      ...
   ```

---

## üí∞ **Tarification**

### **Offre Gratuite**
- ‚úÖ **1 000 pages/mois GRATUITES** (Invoice Parser)
- ‚úÖ Parfait pour d√©marrer et tester

### **Apr√®s la limite gratuite**
- üíµ **$0.65 par page** (Invoice Parser)
- üìä Exemple : 2 000 factures/mois = **$650/mois** (apr√®s les 1 000 premi√®res gratuites)

### **Comparaison avec OpenAI GPT-4o**
| Service | Co√ªt par facture | Pr√©cision | Vitesse |
|---------|------------------|-----------|---------|
| **Google Document AI** | $0.65/page | ‚≠ê‚≠ê‚≠ê‚≠ê‚≠ê (95-98%) | ‚ö°‚ö°‚ö° Tr√®s rapide |
| **OpenAI GPT-4o** | ~$0.10-0.30 | ‚≠ê‚≠ê‚≠ê‚≠ê (85-90%) | ‚ö°‚ö° Moyen |

---

## üéØ **Avantages de Google Document AI**

1. ‚úÖ **Sp√©cialis√© pour les factures** (Invoice Parser entra√Æn√© sur des millions de factures)
2. ‚úÖ **Extraction structur√©e automatique** (montants, dates, TVA, fournisseur, etc.)
3. ‚úÖ **Meilleure pr√©cision** que GPT-4o pour les donn√©es financi√®res
4. ‚úÖ **Pas besoin de prompt engineering** (tout est automatique)
5. ‚úÖ **Support natif des PDF** (pas besoin d'extraire le texte manuellement)
6. ‚úÖ **Multilingue** (fran√ßais, anglais, espagnol, etc.)

---

## üîí **S√©curit√©**

- ‚ö†Ô∏è **NE JAMAIS commiter le fichier `google-credentials.json` sur Git**
- ‚úÖ Ajoutez-le dans `.gitignore` :
  ```
  google-credentials.json
  ```

---

## üÜò **D√©pannage**

### **Erreur : "GOOGLE_CLOUD_PROJECT_ID manquant"**
- V√©rifiez que la variable est bien dans `.env.local`
- Red√©marrez le serveur apr√®s modification

### **Erreur : "Permission denied"**
- V√©rifiez que le compte de service a le r√¥le **"Document AI API User"**
- V√©rifiez que l'API Document AI est bien activ√©e

### **Erreur : "Processor not found"**
- V√©rifiez l'ID du processeur dans Google Cloud Console
- V√©rifiez que la r√©gion correspond (`eu`, `us`, `asia`)

---

## üìö **Documentation Officielle**

- [Google Document AI](https://cloud.google.com/document-ai/docs)
- [Invoice Parser](https://cloud.google.com/document-ai/docs/processors-list#processor_invoice-processor)
- [Tarification](https://cloud.google.com/document-ai/pricing)

---

**üéâ Vous √™tes pr√™t √† extraire des factures avec Google Document AI !**


